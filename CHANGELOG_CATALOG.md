# Изменения в каталоге и корзине

## Дата: 6 декабря 2025

### Исправлено

#### 1. Проблема с отображением категорий и брендов
**Проблема:** Категория "ПОЛИРОЛЬ" и бренд "3M" не отображались в выпадающих списках каталога.

**Причина:** API использовало пагинацию с лимитом 12 элементов, а категории и бренды загружались без указания размера страницы.

**Решение:** 
- Добавлен параметр `?page_size=100` к запросам категорий, брендов и товаров
- Теперь все элементы загружаются корректно

**Файлы:**
- `frontend/src/components/Catalog.js`

#### 2. Добавлена функция добавления в корзину

**Новая функциональность:**
- В каталоге теперь есть кнопка "В корзину" рядом с кнопкой "Подробнее"
- Кнопка показывает состояние загрузки при добавлении товара
- Кнопка неактивна, если товара нет в наличии
- При попытке добавить товар без авторизации пользователь перенаправляется на страницу входа

**Особенности:**
- Используется правильный endpoint: `/api/cart/cart/add_item/`
- Используется `Token` авторизация (не `Bearer`)
- Передается `product_slug` вместо `product_id`
- Количество по умолчанию: 1

**Файлы:**
- `frontend/src/components/Catalog.js` - добавлена кнопка "В корзину"
- `frontend/src/components/ProductDetail.js` - исправлен endpoint для добавления в корзину

### Проверка данных

Создан скрипт для проверки данных в базе:
```bash
python backend/check_data.py
```

**Результаты проверки:**
- Категорий: 4 (лак, ГРУНТЫ, ШПАТКЛЕВКА, ПОЛИРОЛЬ)
- Брендов: 13 (включая 3M)
- Товаров: 16

### Как использовать

1. **Просмотр каталога:**
   - Откройте страницу каталога
   - Выберите категорию "ПОЛИРОЛЬ" в выпадающем списке
   - Выберите бренд "3M" в выпадающем списке
   - Товары отфильтруются автоматически

2. **Добавление в корзину:**
   - Нажмите кнопку "В корзину" на карточке товара
   - Или перейдите на страницу товара и нажмите "Добавить в корзину"
   - Товар будет добавлен в вашу корзину

3. **Требования:**
   - Для добавления товаров в корзину необходимо войти в систему
   - Товар должен быть в наличии (stock > 0)

### Технические детали

**API Endpoints:**
- GET `/api/catalog/categories/?page_size=100` - получение всех категорий
- GET `/api/catalog/brands/?page_size=100` - получение всех брендов
- GET `/api/catalog/products/?page_size=100` - получение всех товаров
- POST `/api/cart/cart/add_item/` - добавление товара в корзину

**Формат запроса добавления в корзину:**
```json
{
  "product_slug": "3m-51815-fast-cut-plus-extreme-polirovalnaya-pasta",
  "quantity": 1
}
```

**Заголовки:**
```
Content-Type: application/json
Authorization: Token <ваш_токен>
```
